!function(e){e.fn.formset=function(s){var a=e.extend({},e.fn.formset.defaults,s),t=a.extraClasses.join(" "),r=e("#id_"+a.prefix+"-TOTAL_FORMS"),d=e("#id_"+a.prefix+"-MAX_NUM_FORMS"),i="input,select,textarea,label,div",l=e(this),n=function(e,s){a.extraClasses&&(e.removeClass(t),e.addClass(a.extraClasses[s%a.extraClasses.length]))},o=function(e,s,a){var t=new RegExp(s+"-(\\d+|__prefix__)-"),r=s+"-"+a+"-";e.attr("for")&&e.attr("for",e.attr("for").replace(t,r)),e.attr("id")&&e.attr("id",e.attr("id").replace(t,r)),e.attr("name")&&e.attr("name",e.attr("name").replace(t,r))},f=function(e){return e.find(i).length>0},c=function(){return 0==d.length||""==d.val()||d.val()-r.val()>0},m=function(s){var t=a.deleteCssClass.trim().replace(/\s+/g,"."),d=a.addCssClass.trim().replace(/\s+/g,".");s.is("TR")?s.children(":last").append('<a class="'+a.deleteCssClass+'" href="#">'+a.deleteText+"</a>"):s.is("UL")||s.is("OL")?s.append('<li><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></li>"):s.is("DIV")?s.append('<div class="col-md-1"><div class="form-group text-right"><br><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></div></div>"):s.append('<a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a>"),s.find("a."+t).click(function(){var s,t=e(this).parents("."+a.formCssClass),l=t.find('input:hidden[id $= "-DELETE"]'),f=t.siblings("a."+d+", ."+a.formCssClass+"-add");l.length?(l.val("on"),t.hide(),s=e("."+a.formCssClass).not(":hidden")):(t.remove(),s=e("."+a.formCssClass).not(".formset-custom-template"),r.val(s.length));for(var m=0,p=s.length;m<p;m++)n(s.eq(m),m),l.length||s.eq(m).find(i).each(function(){o(e(this),a.prefix,m)});return f.is(":hidden")&&c()&&f.show(),a.removed&&a.removed(t),!1})};if(l.each(function(s){var t=e(this),r=t.find('input:checkbox[id $= "-DELETE"]');r.length&&(r.is(":checked")?(r.before('<input type="hidden" name="'+r.attr("name")+'" id="'+r.attr("id")+'" value="on" />'),t.hide()):r.before('<input type="hidden" name="'+r.attr("name")+'" id="'+r.attr("id")+'" />'),e('label[for="'+r.attr("id")+'"]').hide(),r.remove()),f(t)&&(t.addClass(a.formCssClass),t.is(":visible")&&(m(t),n(t,s)))}),l.length){var p,h,C=!c();if(a.formTemplate?(h=a.formTemplate instanceof e?a.formTemplate:e(a.formTemplate),h.removeAttr("id").addClass(a.formCssClass+" formset-custom-template"),h.find(i).each(function(){o(e(this),a.prefix,"__prefix__")}),m(h)):(h=e("."+a.formCssClass+":last").clone(!0).removeAttr("id"),h.find('input:hidden[id $= "-DELETE"]').remove(),h.find(i).not(a.keepFieldValues).each(function(){var s=e(this);s.is("input:checkbox")||s.is("input:radio")?s.attr("checked",!1):s.val("")})),a.formTemplate=h,l.is("TR")){var v=l.eq(0).children().length,u=e('<tr><td colspan="'+v+'"><a class="'+a.addCssClass+'" href="javascript:void(0)">'+a.addText+"</a></tr>").addClass(a.formCssClass+"-add");l.parent().append(u),C&&u.hide(),p=u.find("a")}else l.filter(":last").after('<a class="'+a.addCssClass+'" href="javascript:void(0)">'+a.addText+"</a>"),p=l.filter(":last").next(),C&&p.hide();p.click(function(){var s=parseInt(r.val()),t=a.formTemplate.clone(!0).removeClass("formset-custom-template"),d=e(e(this).parents("tr."+a.formCssClass+"-add").get(0)||this);return n(t,s),t.insertBefore(d).show(),t.find(i).each(function(){o(e(this),a.prefix,s)}),r.val(s+1),c()||d.hide(),a.added&&a.added(t),!1})}return l},e.fn.formset.defaults={prefix:"form",formTemplate:null,addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",formCssClass:"dynamic-form",extraClasses:[],keepFieldValues:"",added:null,removed:null}}(jQuery);